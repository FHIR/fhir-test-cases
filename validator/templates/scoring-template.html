<?xml version="1.0" encoding="UTF-8"?>

<html xml:lang="en" lang="en">
<head>
    <title>FHIR Publisher: [%title%]</title>

  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="http://hl7.org/fhir" name="author"/>
  <meta charset="utf-8" http-equiv="X-UA-Compatible" content="IE=edge" />

  <link rel="stylesheet" href="fhir.css"/>

    <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/assets/css/bootstrap.css"/>
  <link rel="stylesheet" href="/assets/css/bootstrap-fhir.css"/>

    <!-- Project extras -->
  <link rel="stylesheet" href="/assets/css/project.css"/>
  <link rel="stylesheet" href="/assets/css/pygments-manni.css"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- [if lt IE 9]>
  <script src="/assets/js/html5shiv.js"></script>
  <script src="/assets/js/respond.min.js"></script>
  <![endif] -->

    <!-- Favicons -->
  <link sizes="144x144" rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-144-precomposed.png"/>
  <link sizes="114x114" rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-114-precomposed.png"/>
  <link sizes="72x72" rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-72-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-57-precomposed.png"/>
  <link rel="shortcut icon" href="/assets/ico/favicon.png"/>
<script type="text/javascript" src="/assets/js/json2.js"></script>
<script type="text/javascript" src="/assets/js/statuspage.js"></script>
<script type="text/javascript" src="/assets/js/jquery.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery-ui.min.js"></script>
<link rel="stylesheet" href="/assets/css/jquery.ui.all.css">
<script type="text/javascript" src="/assets/js/jquery.ui.core.js"></script>
<script type="text/javascript" src="/assets/js/jquery.ui.widget.js"></script>
<script type="text/javascript" src="/assets/js/jquery.ui.mouse.js"></script>
<script type="text/javascript" src="/assets/js/jquery.ui.resizable.js"></script>
<script type="text/javascript" src="/assets/js/jquery.ui.draggable.js"></script>
<script type="text/javascript" src="/assets/js/jtip.js"></script>
<script type="text/javascript" src="/assets/js/jcookie.js"></script>
<script type="text/javascript" src="/assets/js/fhir-gw.js"></script>

<style>
.status-queued { color: #6c757d; }
.status-building { color: #fd7e14; }
.status-waiting { color: #0dcaf0; }
.status-publishing { color: #fd7e14; }
.status-complete { color: #198754; }
.status-failed { color: #dc3545; }

.task-actions {
  display: flex;
  gap: 5px;
}

.permission-grid {
  display: grid;
  grid-template-columns: 1fr auto auto;
  gap: 10px;
  align-items: center;
}

.output-viewer {
  max-height: 500px;
  overflow-y: auto;
  background: #f8f9fa;
  border: 1px solid #dee2e6;
  padding: 15px;
  border-radius: 5px;
  font-family: monospace;
  white-space: pre-wrap;
}
</style>

</head>

<body>
  
	<div id="segment-navbar" class="segment">  <!-- segment-breadcrumb -->
		<div id="stripe"> </div>
		<div class="container">  <!-- container -->
		<div style="background-color: #ad1f2f; padding: 6px; color: white;">  <!-- container -->
  <a href="http://www.hl7.org/fhir" style="color: gold" title="Fast Healthcare Interoperability Resources - Home Page"><img border="0" src="/icon-fhir-16.png" style="vertical-align: text-bottom"/> <b>FHIR</b></a>

  &copy; HL7.org
  &nbsp;|&nbsp;
  <a href="/" style="color: gold">Server Home</a>   &nbsp;|&nbsp;
  <a href="/publisher" style="color: gold">Publisher Home</a>   &nbsp;|&nbsp;
  <a href="https://github.com/HealthIntersections/nodeserver" style="color: gold">Server Source</a> 
  &nbsp;|&nbsp;
  <a href="http://hl7.org/fhir" style="color: gold">FHIR</a>
  &nbsp;
		</div>  <!-- /container -->
		</div>  <!-- /container -->
</div>

	<!-- /segment-breadcrumb -->

	<div id="segment-content" class="segment">  <!-- segment-content -->
	<div class="container">  <!-- container -->
            <div class="row">
            	<div class="inner-wrapper">
 <div class="col-9">

  <h2>FHIR Implementation Guide Publisher: [%title%] </h2>

[%content%]

 </div>

				</div>  <!-- /inner-wrapper -->
            </div>  <!-- /row -->
        </div>  <!-- /container -->
    </div>  <!-- /segment-content -->

	<div id="segment-footer" class="segment">  <!-- segment-footer -->
		<div class="container">  <!-- container -->
			<div class="inner-wrapper">
				<p>
        <a href="/publisher" style="color: gold">Publisher Home</a>&nbsp;|&nbsp;<a href="/" style="color: gold">Server Home</a>.&nbsp;|&nbsp;FHIR &copy; HL7.org 2011+. &nbsp;|&nbsp;  
        </p>
			</div>  <!-- /inner-wrapper -->
		</div>  <!-- /container -->
	</div>  <!-- /segment-footer -->

	<div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
		<div class="container">  <!-- container -->
		</div>  <!-- /container -->
	</div>  <!-- /segment-post-footer -->

      <!-- JS and analytics only. -->
      <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/respond.min.js"></script>
<script src="/assets/js/fhir.js"></script>

<script>
// Auto-refresh for status updates
function refreshTaskStatus() {
  const currentPath = window.location.pathname;
  if (currentPath.includes('/tasks') && !currentPath.includes('/login')) {
    // Only refresh if we're on tasks page and not editing
    const forms = document.querySelectorAll('form');
    let hasActiveForm = false;
    forms.forEach(form => {
      const inputs = form.querySelectorAll('input, textarea, select');
      inputs.forEach(input => {
        if (input === document.activeElement || input.value !== input.defaultValue) {
          hasActiveForm = true;
        }
      });
    });
    
    if (!hasActiveForm) {
      setTimeout(() => window.location.reload(), 30000); // Refresh every 30 seconds
    }
  }
}

// Start auto-refresh
setTimeout(refreshTaskStatus, 30000);

// Form validation
document.addEventListener('DOMContentLoaded', function() {
  // Validate task creation form
  const taskForm = document.getElementById('create-task-form');
  if (taskForm) {
    taskForm.addEventListener('submit', function(e) {
      const packageId = document.getElementById('npm_package_id');
      const version = document.getElementById('version');
      
      // Basic validation
      if (packageId && packageId.value && !packageId.value.includes('.')) {
        alert('Package ID should contain dots (e.g., hl7.fhir.us.core)');
        e.preventDefault();
        return;
      }
      
      if (version && version.value && !version.value.match(/^\d+\.\d+\.\d+/)) {
        if (!confirm('Version doesn\'t look like semantic versioning (x.y.z). Continue anyway?')) {
          e.preventDefault();
          return;
        }
      }
    });
  }
  
  // Confirm approve actions
  const approveButtons = document.querySelectorAll('button[name="approve"]');
  approveButtons.forEach(button => {
    button.addEventListener('click', function(e) {
      if (!confirm('Are you sure you want to approve this publication task?')) {
        e.preventDefault();
      }
    });
  });
});
</script>

</body>
</html>